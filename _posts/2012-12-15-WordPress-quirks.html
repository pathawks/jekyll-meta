---
title: WordPress quirks
layout: post
---
I am getting really aggravated by WordPress's quirks.

<script src="https://gist.github.com/4301755.js"></script>
<noscript>
<link rel="stylesheet" href="https://gist.github.com/assets/embed-3634f6c602e8992c754bcfc7dad0a593.css" />
<div id="gist4301755" class="gist">
      <div class="gist-file">
        <div class="gist-data gist-syntax">
  <div class="data">
    <table cellpadding="0" cellspacing="0" class="lines highlight">
      <tbody><tr>
        <td class="line_numbers">
          <span id="file-quirkpress-php-L1" rel="file-quirkpress-php-L1">1</span>
          <span id="file-quirkpress-php-L2" rel="file-quirkpress-php-L2">2</span>
          <span id="file-quirkpress-php-L3" rel="file-quirkpress-php-L3">3</span>
          <span id="file-quirkpress-php-L4" rel="file-quirkpress-php-L4">4</span>
          <span id="file-quirkpress-php-L5" rel="file-quirkpress-php-L5">5</span>
          <span id="file-quirkpress-php-L6" rel="file-quirkpress-php-L6">6</span>
          <span id="file-quirkpress-php-L7" rel="file-quirkpress-php-L7">7</span>
          <span id="file-quirkpress-php-L8" rel="file-quirkpress-php-L8">8</span>
          <span id="file-quirkpress-php-L9" rel="file-quirkpress-php-L9">9</span>
          <span id="file-quirkpress-php-L10" rel="file-quirkpress-php-L10">10</span>
          <span id="file-quirkpress-php-L11" rel="file-quirkpress-php-L11">11</span>
          <span id="file-quirkpress-php-L12" rel="file-quirkpress-php-L12">12</span>
          <span id="file-quirkpress-php-L13" rel="file-quirkpress-php-L13">13</span>
          <span id="file-quirkpress-php-L14" rel="file-quirkpress-php-L14">14</span>
          <span id="file-quirkpress-php-L15" rel="file-quirkpress-php-L15">15</span>
          <span id="file-quirkpress-php-L16" rel="file-quirkpress-php-L16">16</span>
          <span id="file-quirkpress-php-L17" rel="file-quirkpress-php-L17">17</span>
          <span id="file-quirkpress-php-L18" rel="file-quirkpress-php-L18">18</span>
          <span id="file-quirkpress-php-L19" rel="file-quirkpress-php-L19">19</span>
          <span id="file-quirkpress-php-L20" rel="file-quirkpress-php-L20">20</span>
          <span id="file-quirkpress-php-L21" rel="file-quirkpress-php-L21">21</span>
          <span id="file-quirkpress-php-L22" rel="file-quirkpress-php-L22">22</span>
          <span id="file-quirkpress-php-L23" rel="file-quirkpress-php-L23">23</span>
          <span id="file-quirkpress-php-L24" rel="file-quirkpress-php-L24">24</span>
          <span id="file-quirkpress-php-L25" rel="file-quirkpress-php-L25">25</span>
          <span id="file-quirkpress-php-L26" rel="file-quirkpress-php-L26">26</span>
          <span id="file-quirkpress-php-L27" rel="file-quirkpress-php-L27">27</span>
          <span id="file-quirkpress-php-L28" rel="file-quirkpress-php-L28">28</span>
          <span id="file-quirkpress-php-L29" rel="file-quirkpress-php-L29">29</span>
          <span id="file-quirkpress-php-L30" rel="file-quirkpress-php-L30">30</span>
          <span id="file-quirkpress-php-L31" rel="file-quirkpress-php-L31">31</span>
          <span id="file-quirkpress-php-L32" rel="file-quirkpress-php-L32">32</span>
          <span id="file-quirkpress-php-L33" rel="file-quirkpress-php-L33">33</span>
          <span id="file-quirkpress-php-L34" rel="file-quirkpress-php-L34">34</span>
          <span id="file-quirkpress-php-L35" rel="file-quirkpress-php-L35">35</span>
          <span id="file-quirkpress-php-L36" rel="file-quirkpress-php-L36">36</span>
          <span id="file-quirkpress-php-L37" rel="file-quirkpress-php-L37">37</span>
          <span id="file-quirkpress-php-L38" rel="file-quirkpress-php-L38">38</span>
          <span id="file-quirkpress-php-L39" rel="file-quirkpress-php-L39">39</span>
          <span id="file-quirkpress-php-L40" rel="file-quirkpress-php-L40">40</span>
          <span id="file-quirkpress-php-L41" rel="file-quirkpress-php-L41">41</span>
          <span id="file-quirkpress-php-L42" rel="file-quirkpress-php-L42">42</span>
          <span id="file-quirkpress-php-L43" rel="file-quirkpress-php-L43">43</span>
          <span id="file-quirkpress-php-L44" rel="file-quirkpress-php-L44">44</span>
          <span id="file-quirkpress-php-L45" rel="file-quirkpress-php-L45">45</span>
          <span id="file-quirkpress-php-L46" rel="file-quirkpress-php-L46">46</span>
          <span id="file-quirkpress-php-L47" rel="file-quirkpress-php-L47">47</span>
        </td>
        <td class="line_data" width="100%">
          <pre><div class="line" id="file-quirkpress-php-LC1"><span class="cp">&lt;?php</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC2"><span class="cm">/*</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC3"><span class="cm"> * WTF DOES THIS CODE DO?</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC4"><span class="cm"> *</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC5"><span class="cm"> * When using get_adjacent_post(), there is no way to restrict posts to one or two categories,</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC6"><span class="cm"> * if the categories in question are not identical to the current post. We get arround that by</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC7"><span class="cm"> * having requesting a list of EVERY CATEGORY EXCEPT the one in question, and then pass that</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC8"><span class="cm"> * as our list of 'excluded' categories.</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC9"><span class="cm"> *</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC10"><span class="cm"> * Take a deep breath.</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC11"><span class="cm"> *</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC12"><span class="cm"> * Yes, it's freaking stupid, but it works.</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC13"><span class="cm"> *</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC14"><span class="cm"> */</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC15"><span class="nv">$post_categories</span> <span class="o">=</span> <span class="nx">get_categories</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC16">      <span class="s1">'exclude'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span> <span class="p">),</span> <span class="c1">// Page and chapter categories</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC17">	<span class="s1">'orderby'</span> <span class="o">=&gt;</span> <span class="s1">'id'</span><span class="p">,</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC18"><span class="p">)</span> <span class="p">);</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC19"><span class="nv">$post_categories</span> <span class="o">=</span> <span class="nx">wp_list_pluck</span><span class="p">(</span> <span class="nv">$post_categories</span><span class="p">,</span> <span class="s1">'cat_ID'</span> <span class="p">);</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC20">&nbsp;</div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC21"><span class="nv">$prev_post</span>   <span class="o">=</span> <span class="nx">get_previous_post</span><span class="p">(</span> <span class="k">FALSE</span><span class="p">,</span> <span class="nv">$post_categories</span> <span class="p">);</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC22"><span class="nv">$next_post</span>   <span class="o">=</span>     <span class="nx">get_next_post</span><span class="p">(</span> <span class="k">FALSE</span><span class="p">,</span> <span class="nv">$post_categories</span> <span class="p">);</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC23">&nbsp;</div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC24"><span class="cm">/*</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC25"><span class="cm"> * For reasons that are not obvious to me,</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC26"><span class="cm"> * while `get_previous_post` and `get_next_post` return a single</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC27"><span class="cm"> * $post object ready to rock, `get_boundary_post` returns an</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC28"><span class="cm"> * ARRAY with a single WordPress post. So that we can use them in</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC29"><span class="cm"> * similar ways, we have to extract the $post from the returned ARRAY.</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC30"><span class="cm"> * http://core.trac.wordpress.org/ticket/22950</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC31"><span class="cm"> */</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC32"><span class="nv">$first_post</span>  <span class="o">=</span> <span class="nb">array_shift</span><span class="p">(</span> <span class="nx">get_boundary_post</span><span class="p">(</span> <span class="k">FALSE</span><span class="p">,</span> <span class="nv">$page_categories</span><span class="p">,</span> <span class="k">TRUE</span> <span class="p">)</span> <span class="p">);</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC33"><span class="nv">$latest_post</span> <span class="o">=</span> <span class="nb">array_shift</span><span class="p">(</span> <span class="nx">get_boundary_post</span><span class="p">(</span> <span class="k">FALSE</span><span class="p">,</span> <span class="nv">$page_categories</span><span class="p">,</span> <span class="k">FALSE</span> <span class="p">)</span> <span class="p">);</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC34">&nbsp;</div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC35"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">is_single</span><span class="p">()</span> <span class="o">||</span> <span class="nx">is_attachment</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC36"><span class="cm">/*</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC37"><span class="cm"> * We'll have to impliment our own workaround for WordPress's broken behavior</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC38"><span class="cm"> *</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC39"><span class="cm"> * I hate this code.</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC40"><span class="cm"> * I hate that I have to include it.</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC41"><span class="cm"> * I hope I can remove it with a future WordPress update.</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC42"><span class="cm"> *</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC43"><span class="cm"> * http://core.trac.wordpress.org/ticket/22957</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC44"><span class="cm"> */</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC45">	<span class="nv">$first_post</span>  <span class="o">=</span> <span class="nb">array_shift</span><span class="p">(</span> <span class="nx">get_posts</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span><span class="s1">'numberposts'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'category__not_in'</span> <span class="o">=&gt;</span> <span class="nv">$page_categories</span><span class="p">,</span> <span class="s1">'order'</span> <span class="o">=&gt;</span> <span class="s1">'ASC'</span><span class="p">,</span>  <span class="s1">'update_post_term_cache'</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span> <span class="s1">'update_post_meta_cache'</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">)</span> <span class="p">)</span> <span class="p">);</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC46">	<span class="nv">$latest_post</span> <span class="o">=</span> <span class="nb">array_shift</span><span class="p">(</span> <span class="nx">get_posts</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span><span class="s1">'numberposts'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'category__not_in'</span> <span class="o">=&gt;</span> <span class="nv">$page_categories</span><span class="p">,</span> <span class="s1">'order'</span> <span class="o">=&gt;</span> <span class="s1">'DESC'</span><span class="p">,</span> <span class="s1">'update_post_term_cache'</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span> <span class="s1">'update_post_meta_cache'</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">)</span> <span class="p">)</span> <span class="p">);</span></div></pre>
          <pre><div class="line" id="file-quirkpress-php-LC47"><span class="p">}</span></div></pre>
        </td>
      </tr>
    </tbody></table>
  </div>
        </div>
        <div class="gist-meta">
          <a href="https://gist.github.com/raw/4301755/9a62715a6ff269d3ace0c74860784f4325234655/QuirkPress.php" style="float:right">view raw</a>
          <a href="https://gist.github.com/4301755#file-quirkpress-php" style="float:right; margin-right:10px; color:#666;">QuirkPress.php</a>
          <a href="https://gist.github.com/4301755">This Gist</a> brought to you by <a href="http://github.com">GitHub</a>.
        </div>
      </div>
</div>
</noscript>

<p><br />
<a href="http://core.trac.wordpress.org/ticket/22950" title="Ticket #22950">Ticket #22950: get_boundary_post Does not return single post object</a><br />
<a href="http://core.trac.wordpress.org/ticket/22957" title="Ticket #22957">Ticket #22957: get_boundary_post Only works from a single page</a>
</p>
